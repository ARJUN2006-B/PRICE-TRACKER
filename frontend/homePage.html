<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Price Tracker</title>
  <link rel="stylesheet" href="home.css" />
 
  <link rel="apple-touch-icon" sizes="180x180" href="/frontend/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/frontend/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/frontend/images/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">

</head>


<body>

  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo">T r a c k I T</div>
    <ul class="nav-links">
    <li><a href="/frontend/About.html">About</a></li>
    <li><a href="/frontend/alerts.html">Alerts</a></li>

   <li id="logoutBtn" style="background-color: #6a0dad; color: white;cursor: pointer;">Logout</li>
    </ul>
  </nav>


  <!-- Header Section -->
  <header>
    <div class="logo-container">
    <img src="images/logo.png" alt="TrackIT Logo" class="main-logo">
</div>
    <p class="tagline">Find the best deals across your favorite stores in one click!</p>
  </header>

  <!-- Ecommerce Logos -->
  

  <!-- Search Bar -->
  <section class="search-section">
 <input type="text" id="productUrl" placeholder="Enter product URL" />
    <button onclick="validateUrl()" style="color: white;">Search</button>
   
  </section>
  <div class="barcode-reader">
  <button type="button" class="barcode-btn" onclick="window.location.href='scanner.html'">
    <img src="images/search-barcode.png" alt="Scan Barcode" />
    <span>Scan Barcode</span>
  </button>
</div>


  <!-- Trending Products Section -->
  <section class="trending-section">
    <h2>ðŸ”¥ Trending Products</h2>
    <div class="product-grid">
      <div class="product-card">
        <a href="https://www.amazon.in/Apple-Bluetooth-Headphones-Personalised-Effortless/dp/B0DGJLL7V1/ref=sr_1_1_sspa?dib=eyJ2IjoiMSJ9.QEf3C-4k27W4meuXe37P4Wj725NU8HwFTVzz85MBAiau4xnePigAHYIeiyouHE9h2Ga9GBNRfCdpSaqC9dLpeT53HquK3Qt_HBwpdDMOzgJW9fg6cHtLj4Lazyz2d13pi8rKHDYlt3Ud671w8ouBWUaKuoyxbEA8-z3uZFr2tHbltcKO8vnPZOB5dJ6m9wA31e1_r_ah9tHyaguTIP74Ws3BdXXAx2MA3JmyQviXgdU.6P9ahQheHyxWvji0oBcHKVMjvhCr_TUCE0OlyHHElQE&dib_tag=se&keywords=airpods&qid=1764061806&sr=8-1-spons&aref=3vTISAVEc4&sp_csd=d2lkZ2V0TmFtZT1zcF9hdGY&psc=1">
        <img src="images/airpod_img.png" alt="Headphones" />
        </a>
        <p>Airpods</p>
      </div>
      <div class="product-card">
        <a href="https://www.amazon.in/Smartwatch-Display-Animated-Functional-Multiple/dp/B0FLF44GTQ/ref=sr_1_5?crid=1PQKS9Q6S79G3&dib=eyJ2IjoiMSJ9.35SrJC2653YsRAcLfKas45RgCYT0vLXlZRHfZAA1oh2lD7LQU2j2rpljiRJhv44biZ8thTNEjzGCcSToT3be__InaPQg3nmOnwzhIFnSXB2XuSFFJXQZBtSTG9_elTTm13PQu5z4jcT9Hv34uEpBD5FYwf1Qz31Elg-7oDQFbmwDj8h8eAhQH9v7qCCCyLMKqyDfjMjMmRnaYtMHblFN0QCgFZqN9fJBhkAdyAv6VFE.uxP_04SdoyJa7CLwKlraz6fAaSo5XERP-437shvsE8U&dib_tag=se&keywords=smart+watch&qid=1764062592&sprefix=smart+watch%2Caps%2C343&sr=8-5">
        <img src="images/samrtwatch_img.jpg" alt="Smartwatch" />
        </a>
        <p>Smartwatch</p>
      </div>
      <div class="product-card">
        <a href="https://www.amazon.in/Campus-11G-677-Black-North-Running/dp/B08PRXXQB3/ref=sr_1_25?crid=139VC5ZS1X1V8&dib=eyJ2IjoiMSJ9.HOdUAAZ6c7BWXygrfsR6TOTppcCPgn8UKXnX3llEghmgz_iJWCyvbEQGNNhc49tG_nKJMEuDAGV8U1vjjRlMvAXGeZ8XKpyUAh2OqnKov08Xm6_G3o5oR7WF_LpURC1-Ti4oVX38Qu4macuXKb1flh8eblGxoIJTbozZK2EUXi0PdD9NOX1wEMkXkTs64CSySNYzuCVxDIOTvUOC0gLUX3A5MHytlqThc4O0_rgKBPUZptYAta_fHcOpsG5yo7LYcNi_MoX1dLLuAErwnOysNTLs-W5DaM4TUk8uW3sXvV0.1lsm8rNovJGv1LRYyuPxXxg7YitMhHFIMkyC7odzFzo&dib_tag=se&keywords=sports%2Bshoe&qid=1764062630&sprefix=sports%2Bshoe%2Caps%2C479&sr=8-25&th=1&psc=1">
        <img src="images/shoe_img.jpg" alt="Shoes" />
        </a>
        <p>Sports Shoes</p>
      </div>
      <div class="product-card">
        <a href="https://www.amazon.in/ZEBRONICS-Transformer-K1-Integrated-Multimedia/dp/B0CGZKPM9F/ref=sr_1_5?crid=3LCIN0ZHO1AI0&dib=eyJ2IjoiMSJ9.D-Hs1YeXIaKq6dUKw1eMS23KVXL-HBx_Rs5DiXjgXK4Cd8MNaW2PGW8b74gDx55id2uFcNoWVov7Hw0RZa6t8NwsR47uV9eX80BkV3fgVpfxbfrI2U3A4C0pQnHRWeFMrR_jok9BQOq0Xc-FPfsqXLb4YgW3gfsVBZcw8-1VVXG87iAgrXs05b8hJQWY4KK-8hvqbqU2Db0QjMoNAQHOet9aMlPvWKfWxSF-KfUFbkE.R0t_1tryPZfx4XjArqgbZB-J-I3T-3ljGyk80dL0OZ0&dib_tag=se&keywords=gaming+keyboard&qid=1764062378&sprefix=gaming+keyboard%2Caps%2C331&sr=8-5">
        <img src="images/gamingkeyboard_img.jpg" alt="Keyboard" />
        </a>
        <p>RGB Gaming Keyboard</p>
      </div>
    </div>
  </section>
  

<!-- Footer -->
<footer>
  <p>Â© 2025 TrackIT | All Rights Reserved</p>
</footer>

<script>

// async function validateUrl() {
//   const input = document.getElementById("productUrl");
//   if (!input) {
//     alert("Product URL input not found");
//     return;
//   }

//   const url = input.value.trim();
//   if (!url) {
//     alert("Please enter a product URL");
//     return;
//   }

//   if (!url.includes("amazon.")) {
//     alert("Only Amazon product URLs are supported right now.");
//     return;
//   }

//   const asin = extractASIN(url);
//   if (!asin) {
//     alert("Couldn't extract ASIN from this URL.");
//     return;
//   }

//   try {
//     // call your backend to scrape + save
//     const res = await fetch("http://localhost:3000/api/fetch", {
//       method: "POST",
//       headers: { "Content-Type": "application/json" },
//       body: JSON.stringify({ url }),
//     });

//     const data = await res.json();
//     console.log("Backend response:", data);

//     if (!res.ok || data.error) {
//       alert("Server error: " + (data.error || "Unknown error"));
//       return;
//     }

//     // redirect to product page with asin
//     window.location.href = `product.html?asin=${asin}`;
//   } catch (err) {
//     console.error(err);
//     alert("Failed to reach backend. Is server running on http://localhost:3000 ?");
//   }
// }

async function validateUrl() {
  const input = document.getElementById("productUrl");
  const loader = document.getElementById("loader");

  if (!input) {
    alert("Product URL input not found");
    return;
  }

  const url = input.value.trim();
  if (!url) {
    alert("Please enter a product URL");
    return;
  }

  if (!url.includes("amazon.")) {
    alert("Only Amazon product URLs are supported.");
    return;
  }

  const asin = extractASIN(url);
  if (!asin) {
    alert("Couldn't extract ASIN from the URL.");
    return;
  }

  // ðŸ‘‰ Show Loader
  loader.style.display = "flex";

  try {
    const res = await fetch("http://localhost:3000/api/fetch", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ url }),
    });

    const data = await res.json();
    console.log("Backend response:", data);

    if (!res.ok || data.error) {
      alert("Server error: " + (data.error || "Unknown error"));
      loader.style.display = "none"; // Hide loader if error
      return;
    }

    // ðŸ‘‰ Redirect to product page
    window.location.href = `product.html?asin=${asin}`;

  } catch (err) {
    console.error(err);
    alert("Failed to reach backend. Is server running?");
    loader.style.display = "none"; // Hide loader if failure
  }
}

function extractASIN(url) {
  const patterns = [
    /\/dp\/([A-Z0-9]{10})/i,
    /\/gp\/product\/([A-Z0-9]{10})/i,
    /\/product\/([A-Z0-9]{10})/i,
    /\/([A-Z0-9]{10})(?:[/?]|$)/i,
  ];
  for (const p of patterns) {
    const m = url.match(p);
    if (m) return m[1];
  }
  return null;
}

</script>

<script>
window.addEventListener("load", () => {
  document.getElementById("loader").style.display = "none";
});
</script>


<script type="module" src="./firebase/config.js"></script>
<script type="module" src="./Login.js"></script>

<!-- Loader Overlay -->
<div id="loader" class="loader-overlay">
    <div class="spinner"></div>
    <p class="loader-text">Loading...</p>
</div>

</body>
</html>
